
<head>
	<meta charset="utf-8"/>
	<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <script src="/libs/FileSaver.js" type="text/javascript"></script>

    <!-- auto-generated imports -->
    <script src="/util//Tools.js" type="text/javascript"></script>
    <script src="/util//Player.js" type="text/javascript"></script>
    <script src="/util//PlaybackControl.js" type="text/javascript"></script>
    <script src="/util//Playback.js" type="text/javascript"></script>
    <script src="/util//Compose.js" type="text/javascript"></script>
    <script src="/util//PianoLayoutPanel.js" type="text/javascript"></script>
    <script src="/util//TableGenerator.js" type="text/javascript"></script>
    <script src="/util//DataStructures.js" type="text/javascript"></script>
    <script src="/util/synths/MidiDevice.js" type="text/javascript"></script>
    <script src="/util/synths/ISynth.js" type="text/javascript"></script>
    <script src="/util/sheet_music/ShapeProvider.js" type="text/javascript"></script>
    <script src="/util/sheet_music/Supply.js" type="text/javascript"></script>
    <script src="/util/typescript/Shmidusicator.js" type="text/javascript"></script>
    <script src="/util/typescript/DataStructures.js" type="text/javascript"></script>
    <script src="/util/typescript/Tools.js" type="text/javascript"></script>
    <script src="/util/typescript/UnfairRandom.js" type="text/javascript"></script>
    <script src="/util/typescript/references.js" type="text/javascript"></script>
    <script src="/util/typescript/Reflect.js" type="text/javascript"></script>
    <script src="/util/typescript/Maybe.js" type="text/javascript"></script>
    <script src="/util/typescript/synths/ISynth.js" type="text/javascript"></script>
    <script src="/util/typescript/synths/Oscillator.js" type="text/javascript"></script>
    <script src="/util/typescript/synths/Fluid.js" type="text/javascript"></script>
    <script src="/util/typescript/compose/Handler.js" type="text/javascript"></script>
    <script src="/util/typescript/sheet_music/Painter.js" type="text/javascript"></script>
    <script src="/util/typescript/sheet_music/Control.js" type="text/javascript"></script>
    <script src="/util/flowOut/Linker.js" type="text/javascript"></script>
    <script src="/util/flowOut/GoogleTranslateAdapter.js" type="text/javascript"></script>
    <script src="/util/flowOut/Transeeker.js" type="text/javascript"></script>

</head>

<span id="playbackConfigDiv">
    Tempo: <input type="number" class="holder tempo" value="120" min="15" max="480"
                  onchange="this.value = Math.min(Math.max(this.value, this.min), this.max);"/>
    Loop Start: <input type="number" class="holder loopStart" value="0"/>
    Loop Times: <input type="number" class="holder loopTimes" value="0"/>
    <span id="visualConfigDiv">
        Tact Size: <input type="number" class="holder tactSize" value="1" min="0.25" max="16" step="0.25"
                          onchange="this.value = Math.min(Math.max(this.value, this.min), this.max);"/>
    </span>
    Channels: <span class="channelListTable channelColors"></span>
</span>

<div id="sheetMusicDiv"></div>

<script>

    var onLoad = function ()
    {
        var painter = Ns.SheetMusicPainter('sheetMusicDiv', $('#visualConfigDiv')[0]);
        painter.setEnabled(true);

        var handler = Ns.Compose.Handler(painter, $('#playbackConfigDiv')[0]);

        var sheetMusicCont = $('#sheetMusicDiv')[0];
        $(sheetMusicCont).attr('tabindex', 1);
        handler.hangKeyboardHandlers(sheetMusicCont);
        handler.hangGlobalKeyboardHandlers();

        $('body').click(function(e) {
            if (e.target.tagName.toLowerCase() !== 'input') {
                $(sheetMusicCont).focus();
            }
        });

        $(sheetMusicCont).focus();
    };

    window.addEventListener('load', onLoad, false);

</script>


<style>

    /** @TODO: export this to js somehow */

    .channelColors [data-channel="0"] { color: rgb(0, 0, 0); } /* black */
    .channelColors [data-channel="1"] { color: rgb(192, 0, 0); } /* red */
    .channelColors [data-channel="2"] { color: rgb(0, 148, 0); } /* green */
    .channelColors [data-channel="3"] { color: rgb(60, 60, 255); } /* blue */
    .channelColors [data-channel="4"] { color: rgb(152, 152, 0); } /* yellow */
    .channelColors [data-channel="5"] { color: rgb(0, 152, 152); } /* cyan */
    .channelColors [data-channel="6"] { color: rgb(192, 0, 192); } /* magenta */
    .channelColors [data-channel="7"] { color: rgb(255, 128, 0); } /* orange */
    .channelColors [data-channel="8"] { color: rgb(91, 0, 255); } /* bluish magenta */
    .channelColors [data-channel="9"] { color: rgb(128, 128, 128); } /* drum */

    .channelColors [data-channel="10"] { color: rgb(127, 255, 0); } /* TODO: !!! */
    .channelColors [data-channel="11"] { color: rgb(255, 0, 255); } /* TODO: !!! */
    .channelColors [data-channel="12"] { color: rgb(0, 255, 0); } /* TODO: !!! */
    .channelColors [data-channel="13"] { color: rgb(0, 255, 0); } /* TODO: !!! */
    .channelColors [data-channel="14"] { color: rgb(0, 255, 0); } /* TODO: !!! */
    .channelColors [data-channel="15"] { color: rgb(0, 255, 0); } /* TODO: !!! */

    .channelListTable { font-weight: bold; }

    .channelListTable > span {
        margin-right: 10px;
        width: 40px;
        overflow: hidden;
        white-space: nowrap;
        border-right: solid red 1px;
    }
    body {
        font-size: 12px;
        font-family: monospace;
    }
    #sheetMusicDiv {
        margin-top: 20px;
        min-height: 120px;
    }
    input[type="number"] {
        width: 60px;
        margin-right: 15px;
    }
    span {
        display: inline-block;
    }
    #sheetMusicDiv {
        outline: none;
    }

</style>