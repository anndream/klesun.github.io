<script src="/libs/jquery-1.11.3.js" type="text/javascript"></script>
<script src="/util/Tools.js" type="text/javascript"></script>

<button onclick='playpause()'>play/pause</button><br>
<input id='input' value='100'>cent <button onclick='setDetune()'>set</button>
<script>
    // Temporary workaround until AudioContext is standardized
    window.AudioContext = window.AudioContext || window.webkitAudioContext;

    var context = new AudioContext();
    var oscillator = context.createOscillator();
    oscillator.start(0);
    var connected = false;

    var playpause = function() {
        if (!connected) {
            var gainNode = context.createGain();
            gainNode.connect(context.destination);

            oscillator.connect(gainNode);
            gainNode.gain.value = 0;
            setTimeout((_) => gainNode.gain.value = 0.2, 5);

            ZHOPA = (_) => gainNode.gain.value = 0.2;
            PIZDA = (_) => gainNode.gain.value = 0;
//            Util.forEachBreak(Util.range(0,3), 5, 1, function(i)
//            {
//                gainNode.gain.value = 0.2 * i;
//            });
//            gainNode.gain.value = 0.2;
        }
        else {
            oscillator.disconnect();
        }
        connected = !connected;
    };

    var setDetune = function() {
        var input = document.getElementById('input');
        oscillator.detune.value = +input.value;
    };
</script>
